<HTML>
<HEAD>
<TITLE>C= 1581 Service Manual: WD1770 Floppy Disk Controller (cont.)</TITLE><meta name="viewport" content="width=device-width, initial-scale=1">
</HEAD>
<BODY TEXTCOLOR="#000000" BGCOLOR="#FFFFFF">

<A HREF="Page_09.html">
<IMG SRC="blue_prev.gif" ALT="[Prev]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="Page_11.html">
<IMG SRC="blue_next.gif" ALT="[Next]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="Contents.html">
<IMG SRC="blue_toc.gif" ALT="[Contents]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="../../index.html">
<IMG SRC="blue_cbm.gif" ALT="[Commodore]" BORDER=0 HEIGHT=24 WIDTH=22></A>
<A HREF="http://www.devili.iki.fi/general/new.html" title="New">
<IMG SRC="blue_new.gif" ALT="[New]" BORDER=0 HEIGHT=24 WIDTH=27></A>
<A HREF="https://www.devili.iki.fi/" title="Home">
<IMG SRC="blue_home.gif" ALT="[Home]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<BR>

<HR>

<CENTER>
<H2>WD1770 FLOPPY DISK CONTROLLER (CONTINUED)</H2>

<BR>
<IMG SRC="Page_10.gif" WIDTH="601" HEIGHT="563" ALT="BLOCK DIAGRAM">
</CENTER>
<BR>

<B>ARCHITECTURE</B>

<P>The Floppy Disk Controller block diagram is illustrated above. The primary sections include the parallel processor interface and the Floppy Disk Interface.

<P><B>Data Shift Register</B> &nbsp;&#151;&nbsp; This 8-bit register assembles serial data from the Read Data input (<img src="rd.gif" ALT="RD">) during Read operations and transfers serial data to the Write Data output during Write operations.

<P><B>Data Register (DR)</B> &nbsp;&#151;&nbsp; This 8-bit register is used as a holding register during Disk Read and Write operations. In Disk Read operations, the assembled data byte is transferred in parallel to the Data Register from the Data Shift Register. In Disk Write operations, information is transferred in parallel from the Data Register to the Data Shift Register. When executing the Seek command, the Data Register holds the address of the desired Track position. This register is loaded from the DAL and gated onto the DAL under processor control.

<P><B>Track Register (TR)</B> &nbsp;&#151;&nbsp; This 8-bit register holds the track number of the current Read/Write head position. It is incremented by one every time the head is stepped in and decremented by one when the head is stepped out (towards track 00). The contents of the register are compared with the recorded track number in the ID field during disk Read, Write, and Verify operations. The Track Register can be loaded from or transferred to the DAL. This Register should not be loaded when the device is busy.

<P><B>Sector Register (SR)</B> &nbsp;&#151;&nbsp; This 8-bit register holds the address of the desired sector position. The contents of the register are compared with the recorded sector number in the ID field during disk Read or Write operations. The Sector Register contents can be loaded from or transferred to the DAL. This register should not be loaded when the device is busy.

<P><B>Command Register (CR)</B> &nbsp;&#151;&nbsp; This 8-bit register holds the command presently being executed. This register should not be loaded when the device is busy unless the new command is a force interrupt. The command register can be loaded from the DAL, but not read onto the DAL.

<P><B>Status Register (STR)</B> &nbsp;&#151;&nbsp; This 8-bit register holds device Status information. The meaning of the Status bits is a function of the type of command previously executed. This register can be read onto the DAL, but not loaded from the DAL.

<P><B>CRC Logic</B> &nbsp;&#151;&nbsp; This logic is used to check or to generate the 16-bit Cyclic Redundancy Check (CRC). The polynomial is: G(x) = x<SUP>16</SUP> + x<SUP>2</SUP> + x<SUP>5</SUP> + 1. The CRC includes all information starting with the address mark and up to the CRC characters. The CRC register is preset to ones prior to data being shifted through the circuit.</P>

<HR>

<A HREF="Page_09.html">
<IMG SRC="blue_prev.gif" ALT="[Prev]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="Page_11.html">
<IMG SRC="blue_next.gif" ALT="[Next]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="Contents.html">
<IMG SRC="blue_toc.gif" ALT="[Contents]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<A HREF="../../index.html">
<IMG SRC="blue_cbm.gif" ALT="[Commodore]" BORDER=0 HEIGHT=24 WIDTH=22></A>
<A HREF="http://www.devili.iki.fi/general/new.html" title="New">
<IMG SRC="blue_new.gif" ALT="[New]" BORDER=0 HEIGHT=24 WIDTH=27></A>
<A HREF="https://www.devili.iki.fi/" title="Home">
<IMG SRC="blue_home.gif" ALT="[Home]" BORDER=0 HEIGHT=24 WIDTH=24></A>
<BR>

<CENTER>
This page has been created by <A HREF="mailto:frank@kontr.uzhgorod.ua">
Frank Kontros</A>.<BR>Last updated May 14th, 1999.
</CENTER>

</BODY>
</HTML>
